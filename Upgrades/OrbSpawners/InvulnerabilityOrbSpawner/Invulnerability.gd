extends Node2D

export(Resource) var bobber_stats = bobber_stats as BobberStats

onready var duration = $Duration

var previous_damage_taken_multiplier : float

func _ready() -> void:
	bobber_stats.is_invulnerable += 1
	get_parent().bobber_sprite.modulate = Color( 0, 0, 0, 1 )


func set_incremented_values(new_incremented_values) -> void:
	duration.wait_time = new_incremented_values[0]
	duration.start()


func _physics_process(delta):
	if duration.time_left > 0:
		if bobber_stats.reel_damage > 0:
			bobber_stats.previous_reel_damage = bobber_stats.reel_damage
			bobber_stats.reel_damage = 0


func _on_Duration_timeout():
	bobber_stats.reel_damage = bobber_stats.previous_reel_damage
	bobber_stats.previous_reel_damage = 0
	bobber_stats.is_invulnerable -= 1
	print(bobber_stats.is_invulnerable)
	if bobber_stats.is_invulnerable == 0:
		get_parent().bobber_sprite.modulate = Color( 1, 1, 1, 1 )
	queue_free()
